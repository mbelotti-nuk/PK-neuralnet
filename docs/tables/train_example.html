<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pkdnn training module - parameters &mdash; Point Kernel Deep Neural Network 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pkdnn prediction module - parameters" href="predict_example.html" />
    <link rel="prev" title="Database process moduel - parameters" href="inp_proc_example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Point Kernel Deep Neural Network
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Package.html">pkdnn Package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Usage.html">Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Usage.html#database-creation">Database creation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Usage.html#pkdnn-training">Pkdnn training</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Pkdnn training module - parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#io-paths"><code class="docutils literal notranslate"><span class="pre">io_paths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#inp-spec"><code class="docutils literal notranslate"><span class="pre">inp_spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#out-spec"><code class="docutils literal notranslate"><span class="pre">out_spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nn-spec"><code class="docutils literal notranslate"><span class="pre">nn_spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#training-parameters"><code class="docutils literal notranslate"><span class="pre">training_parameters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#metrics"><code class="docutils literal notranslate"><span class="pre">metrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer"><code class="docutils literal notranslate"><span class="pre">optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lr-scheduler"><code class="docutils literal notranslate"><span class="pre">lr_scheduler</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Usage.html#pkdnn-prediction">Pkdnn prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Usage.html#export-to-nacarte">Export to NACARTE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules of pkdnn</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Point Kernel Deep Neural Network</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Usage.html">Usage</a></li>
      <li class="breadcrumb-item active">Pkdnn training module - parameters</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tables/train_example.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pkdnn-training-module-parameters">
<h1>Pkdnn training module - parameters<a class="headerlink" href="#pkdnn-training-module-parameters" title="Permalink to this headline"></a></h1>
<p>Any information about this page goes here.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table><section id="io-paths">
<h2><code class="docutils literal notranslate"><span class="pre">io_paths</span></code><a class="headerlink" href="#io-paths" title="Permalink to this headline"></a></h2>
<p>Path to input and output quantities for training. In this case the input is the folder in which the database is stored and the output is is the folder in which save the trained neural network.</p>
<section id="member-variables">
<h3>Member variables:<a class="headerlink" href="#member-variables" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>path_to_database</code></td>
<td style="text-align: center;"><code>\absolute\path\to\database</code></td>
<td style="text-align: left;">Path to input and output quantities for training.<br />In this case the input is the folder in which the<br />database is stored and the output is is the folder<br />in which save the trained neural network. Database<br />specifications Path pointing to the folder in<br />which are stored database files</td>
</tr>
<tr>
<td style="text-align: center;"><code>save_directory</code></td>
<td style="text-align: center;"><code>""</code></td>
<td style="text-align: left;">Path in which the folder containing the results<br />will be created</td>
</tr>
</tbody>
</table></section>
</section>
<section id="inp-spec">
<h2><code class="docutils literal notranslate"><span class="pre">inp_spec</span></code><a class="headerlink" href="#inp-spec" title="Permalink to this headline"></a></h2>
<section id="id1">
<h3>Member variables:<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>inputs</code></td>
<td style="text-align: center;"><code>['energy', 'dist_source_tally','dist_shield_tally','mfp','theta','fi']</code></td>
<td style="text-align: left;">Neural network Inputs</td>
</tr>
<tr>
<td style="text-align: center;"><code>database_inputs</code></td>
<td style="text-align: center;"><code>null</code></td>
<td style="text-align: left;">Inputs that are present in the database files.<br />This input should be specified in case the Neural<br />network Inputs (variable above) is a subset of the<br />actual database input set.</td>
</tr>
<tr>
<td style="text-align: center;"><code>inp_scaletype</code></td>
<td style="text-align: center;"><code>{'energy': 'minmax', 'dist_source_tally': 'std', 'dist_shield_tally': 'std', 'mfp': 'std', 'theta': 'std', 'fi': 'std'}</code></td>
<td style="text-align: left;">Scaling type for each input</td>
</tr>
</tbody>
</table></section>
</section>
<section id="out-spec">
<h2><code class="docutils literal notranslate"><span class="pre">out_spec</span></code><a class="headerlink" href="#out-spec" title="Permalink to this headline"></a></h2>
<section id="id2">
<h3>Member variables:<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>output</code></td>
<td style="text-align: center;"><code>"B"</code></td>
<td style="text-align: left;">Neural newtork Output</td>
</tr>
<tr>
<td style="text-align: center;"><code>out_scaletype</code></td>
<td style="text-align: center;"><code>{'B': 'std'}</code></td>
<td style="text-align: left;">Output scaling type</td>
</tr>
<tr>
<td style="text-align: center;"><code>out_clip</code></td>
<td style="text-align: center;"><code>[1, 1E+21]</code></td>
<td style="text-align: left;">Clip output to a [min, max]</td>
</tr>
<tr>
<td style="text-align: center;"><code>out_log_scale</code></td>
<td style="text-align: center;"><code>True</code></td>
<td style="text-align: left;">Use log-scale for training</td>
</tr>
<tr>
<td style="text-align: center;"><code>mesh_dim</code></td>
<td style="text-align: center;"><code>[80,100,35]</code></td>
<td style="text-align: left;">Number of voxels in X, Y, Z directions for the<br />reference mesh in the database</td>
</tr>
</tbody>
</table></section>
</section>
<section id="nn-spec">
<h2><code class="docutils literal notranslate"><span class="pre">nn_spec</span></code><a class="headerlink" href="#nn-spec" title="Permalink to this headline"></a></h2>
<section id="id3">
<h3>Member variables:<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>f_maps</code></td>
<td style="text-align: center;"><code>[6,128,64,8]</code></td>
<td style="text-align: left;">DNN architecture a list that gives to each layer<br />the corresponing number of neurons note that<br />f_maps[0] has to be equal to the number of inputs</td>
</tr>
<tr>
<td style="text-align: center;"><code>n_files</code></td>
<td style="text-align: center;"><code>200 #'None</code></td>
<td style="text-align: left;">n_files: number of files from database to be used<br />in training. if null, all the files are used</td>
</tr>
<tr>
<td style="text-align: center;"><code>samples_per_case</code></td>
<td style="text-align: center;"><code>100</code></td>
<td style="text-align: left;">samples_per_case: number of points used for<br />training for each file of the database. if None,<br />all the points are used which corresponds to<br />mesh_dim[0]<em>mesh_dim[1]</em>mesh_dim[2]</td>
</tr>
<tr>
<td style="text-align: center;"><code>percentage</code></td>
<td style="text-align: center;"><code>0.75</code></td>
<td style="text-align: left;">percentage for training/validation splitting</td>
</tr>
</tbody>
</table></section>
</section>
<section id="training-parameters">
<h2><code class="docutils literal notranslate"><span class="pre">training_parameters</span></code><a class="headerlink" href="#training-parameters" title="Permalink to this headline"></a></h2>
<section id="id4">
<h3>Member variables:<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>batch_size</code></td>
<td style="text-align: center;"><code>2048</code></td>
<td style="text-align: left;">Size of the batch</td>
</tr>
<tr>
<td style="text-align: center;"><code>n_epochs</code></td>
<td style="text-align: center;"><code>1</code></td>
<td style="text-align: left;">Number of epochs in the training</td>
</tr>
<tr>
<td style="text-align: center;"><code>patience</code></td>
<td style="text-align: center;"><code>10</code></td>
<td style="text-align: left;">Number of epochs to wait with no improvements in<br />the loss function before stopping the training</td>
</tr>
<tr>
<td style="text-align: center;"><code>mixed_precision</code></td>
<td style="text-align: center;"><code>False</code></td>
<td style="text-align: left;">Use of mixed precision float 16/32 in GPU training<br />ref: https://pytorch.org/tutorials/recipes/recipes<br />/amp_recipe.html</td>
</tr>
</tbody>
</table></section>
</section>
<section id="metrics">
<h2><code class="docutils literal notranslate"><span class="pre">metrics</span></code><a class="headerlink" href="#metrics" title="Permalink to this headline"></a></h2>
<section id="id5">
<h3>Member variables:<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>loss</code></td>
<td style="text-align: center;"><code>"mse"</code></td>
<td style="text-align: left;">Loss function</td>
</tr>
<tr>
<td style="text-align: center;"><code>accuracy</code></td>
<td style="text-align: center;"><code>"l1"</code></td>
<td style="text-align: left;">Accuracy function</td>
</tr>
</tbody>
</table></section>
</section>
<section id="optimizer">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer</span></code><a class="headerlink" href="#optimizer" title="Permalink to this headline"></a></h2>
<section id="id6">
<h3>Member variables:<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>type</code></td>
<td style="text-align: center;"><code>"adamw"</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;"><code>learning_rate</code></td>
<td style="text-align: center;"><code>0.001</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: center;"><code>weight_decay</code></td>
<td style="text-align: center;"><code>0.001</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table></section>
</section>
<section id="lr-scheduler">
<h2><code class="docutils literal notranslate"><span class="pre">lr_scheduler</span></code><a class="headerlink" href="#lr-scheduler" title="Permalink to this headline"></a></h2>
<p>ref: https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.ReduceLROnPlateau.html</p>
<section id="id7">
<h3>Member variables:<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th style="text-align: center;">Value</th>
<th style="text-align: left;">Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>factor</code></td>
<td style="text-align: center;"><code>0.5</code></td>
<td style="text-align: left;">ref: https://pytorch.org/docs/stable/generated/tor<br />ch.optim.lr_scheduler.ReduceLROnPlateau.html</td>
</tr>
<tr>
<td style="text-align: center;"><code>patience</code></td>
<td style="text-align: center;"><code>5</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table><hr class="docutils" />
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="inp_proc_example.html" class="btn btn-neutral float-left" title="Database process moduel - parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="predict_example.html" class="btn btn-neutral float-right" title="Pkdnn prediction module - parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mario Belotti.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>